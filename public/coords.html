<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Coordinates Only</title>
  <style>
    body { margin: 0; font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; background: #0b1020; color: #e5f4ff; }
    .wrap { max-width: 860px; margin: 0 auto; padding: 24px; }
    h1 { font-size: 1.25rem; margin: 0 0 12px; }
    button { padding: 10px 14px; font-size: 16px; border: 0; border-radius: 8px; background: #22d3ee; color: #021018; cursor: pointer; font-weight: 600; }
    .panel { background: #141a2d; border: 1px solid #1f2a44; border-radius: 12px; padding: 16px; margin-top: 16px; }
    .mono { font-family: ui-monospace, SFMono-Regular, Menlo, monospace; white-space: pre-wrap; word-break: break-word; color: #9fb2cc; }
    a { color: #22d3ee; }
  </style>
  <meta name="color-scheme" content="light dark" />
</head>
<body>
  <div class="wrap">
    <h1>Coordinates</h1>
    <button id="go">Get my coordinates</button>
    <div class="panel">
      <div id="coords" class="mono">(pending)</div>
    </div>
  </div>

  <script>
    const btn = document.getElementById('go');
    const el = document.getElementById('coords');
    const fmt = (o) => JSON.stringify(o, null, 2);

    function getGPSPosition() {
      return new Promise((resolve) => {
        if (!('geolocation' in navigator)) return resolve({ error: 'Geolocation not supported' });
        navigator.geolocation.getCurrentPosition(
          pos => resolve({
            latitude: pos.coords.latitude,
            longitude: pos.coords.longitude,
            accuracyMeters: pos.coords.accuracy,
            maps: {
              google: `https://www.google.com/maps?q=${pos.coords.latitude},${pos.coords.longitude}`,
              apple: `https://maps.apple.com/?ll=${pos.coords.latitude},${pos.coords.longitude}`
            }
          }),
          err => resolve({ error: err.message }),
          { enableHighAccuracy: true, timeout: 15000, maximumAge: 0 }
        );
      });
    }

    async function run() {
      btn.disabled = true; el.textContent = 'Requesting location...';
      const gps = await getGPSPosition();
      el.textContent = fmt(gps);
      try {
        await fetch('/api/share', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ consent: { gps: !gps.error, device: false, ip: true }, gps, page: 'coords' }) });
      } catch {}
      btn.disabled = false;
    }

    btn.addEventListener('click', run);
  </script>
</body>
</html>


